<?php

/**
 * This file is part of the Phalcon Framework.
 *
 * For the full copyright and license information, please view the LICENSE.md
 * file that was distributed with this source code.
 */

declare(strict_types=1);

namespace Phalcon\Tests\Database\DataMapper\Info\Adapter\Sqlite;

use Phalcon\DataMapper\Info\Adapter\Sqlite;
use Phalcon\Tests\AbstractDatabaseTestCase;

final class ListColumnsTest extends AbstractDatabaseTestCase
{
    /**
     * @since  2025-01-14
     *
     * @group  sqlite
     */
    public function testDmInfoAdapterMysqlListTables(): void
    {
        $connection = self::getDataMapperConnection();

        $sqlite = new Sqlite($connection);
        $schema = $sqlite->getCurrentSchema();

        $expected = [
            'field_primary'           => [
                'afterField'      => null,
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => true,
                'isFirst'         => true,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => true,
                'isUnsigned'      => false,
                'name'            => 'field_primary',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'integer',
            ],
            'field_blob'              => [
                'afterField'      => 'field_primary',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_blob',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'blob',
            ],
            'field_binary'            => [
                'afterField'      => 'field_blob',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_binary',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'blob',
            ],
            'field_bit'               => [
                'afterField'      => 'field_binary',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_bit',
                'options'         => null,
                'scale'           => null,
                'size'            => 10,
                'type'            => 'integer',
            ],
            'field_bit_default'       => [
                'afterField'      => 'field_bit',
                'comment'         => '',
                'default'         => 1,
                'hasDefault'      => true,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_bit_default',
                'options'         => null,
                'scale'           => null,
                'size'            => 10,
                'type'            => 'integer',
            ],
            'field_bigint'            => [
                'afterField'      => 'field_bit_default',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_bigint',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'integer',
            ],
            'field_bigint_default'    => [
                'afterField'      => 'field_bigint',
                'comment'         => '',
                'default'         => 1,
                'hasDefault'      => true,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_bigint_default',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'integer',
            ],
            'field_boolean'           => [
                'afterField'      => 'field_bigint_default',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_boolean',
                'options'         => null,
                'scale'           => null,
                'size'            => 1,
                'type'            => 'integer',
            ],
            'field_boolean_default'   => [
                'afterField'      => 'field_boolean',
                'comment'         => '',
                'default'         => 1,
                'hasDefault'      => true,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_boolean_default',
                'options'         => null,
                'scale'           => null,
                'size'            => 1,
                'type'            => 'integer',
            ],
            'field_char'              => [
                'afterField'      => 'field_boolean_default',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_char',
                'options'         => null,
                'scale'           => null,
                'size'            => 10,
                'type'            => 'char',
            ],
            'field_char_default'      => [
                'afterField'      => 'field_char',
                'comment'         => '',
                'default'         => 'ABC',
                'hasDefault'      => true,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_char_default',
                'options'         => null,
                'scale'           => null,
                'size'            => 10,
                'type'            => 'char',
            ],
            'field_decimal'           => [
                'afterField'      => 'field_char_default',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_decimal',
                'options'         => null,
                'scale'           => 4,
                'size'            => 10,
                'type'            => 'numeric',
            ],
            'field_decimal_default'   => [
                'afterField'      => 'field_decimal',
                'comment'         => '',
                'default'         => 14.5678,
                'hasDefault'      => true,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_decimal_default',
                'options'         => null,
                'scale'           => 4,
                'size'            => 10,
                'type'            => 'numeric',
            ],
            'field_enum'              => [
                'afterField'      => 'field_decimal_default',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_enum',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'text',
            ],
            'field_integer'           => [
                'afterField'      => 'field_enum',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_integer',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'integer',
            ],
            'field_integer_default'   => [
                'afterField'      => 'field_integer',
                'comment'         => '',
                'default'         => 1,
                'hasDefault'      => true,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_integer_default',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'integer',
            ],
            'field_json'              => [
                'afterField'      => 'field_integer_default',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_json',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'text',
            ],
            'field_float'             => [
                'afterField'      => 'field_json',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_float',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'real',
            ],
            'field_float_default'     => [
                'afterField'      => 'field_float',
                'comment'         => '',
                'default'         => 14.5678,
                'hasDefault'      => true,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_float_default',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'real',
            ],
            'field_date'              => [
                'afterField'      => 'field_float_default',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_date',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'datetime',
            ],
            'field_date_default'      => [
                'afterField'      => 'field_date',
                'comment'         => '',
                'default'         => '2018-10-01',
                'hasDefault'      => true,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_date_default',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'datetime',
            ],
            'field_datetime'          => [
                'afterField'      => 'field_date_default',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_datetime',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'datetime',
            ],
            'field_datetime_default'  => [
                'afterField'      => 'field_datetime',
                'comment'         => '',
                'default'         => '2018-10-01 12:34:56',
                'hasDefault'      => true,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_datetime_default',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'datetime',
            ],
            'field_time'              => [
                'afterField'      => 'field_datetime_default',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_time',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'datetime',
            ],
            'field_time_default'      => [
                'afterField'      => 'field_time',
                'comment'         => '',
                'default'         => '12:34:56',
                'hasDefault'      => true,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_time_default',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'datetime',
            ],
            'field_timestamp'         => [
                'afterField'      => 'field_time_default',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_timestamp',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'datetime',
            ],
            'field_timestamp_default' => [
                'afterField'      => 'field_timestamp',
                'comment'         => '',
                'default'         => '2018-10-01 12:34:56',
                'hasDefault'      => true,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_timestamp_default',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'datetime',
            ],
            'field_timestamp_current' => [
                'afterField'      => 'field_timestamp_default',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_timestamp_current',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'datetime',
            ],
            'field_mediumint'         => [
                'afterField'      => 'field_timestamp_current',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_mediumint',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'integer',
            ],
            'field_mediumint_default' => [
                'afterField'      => 'field_mediumint',
                'comment'         => '',
                'default'         => 1,
                'hasDefault'      => true,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_mediumint_default',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'integer',
            ],
            'field_smallint'          => [
                'afterField'      => 'field_mediumint_default',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_smallint',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'integer',
            ],
            'field_smallint_default'  => [
                'afterField'      => 'field_smallint',
                'comment'         => '',
                'default'         => 1,
                'hasDefault'      => true,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_smallint_default',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'integer',
            ],
            'field_tinyint'           => [
                'afterField'      => 'field_smallint_default',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_tinyint',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'integer',
            ],
            'field_tinyint_default'   => [
                'afterField'      => 'field_tinyint',
                'comment'         => '',
                'default'         => 1,
                'hasDefault'      => true,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => true,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_tinyint_default',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'integer',
            ],
            'field_longtext'          => [
                'afterField'      => 'field_tinyint_default',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_longtext',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'text',
            ],
            'field_mediumtext'        => [
                'afterField'      => 'field_longtext',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_mediumtext',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'text',
            ],
            'field_tinytext'          => [
                'afterField'      => 'field_mediumtext',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_tinytext',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'text',
            ],
            'field_text'              => [
                'afterField'      => 'field_tinytext',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_text',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'text',
            ],
            'field_varbinary'         => [
                'afterField'      => 'field_text',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_varbinary',
                'options'         => null,
                'scale'           => null,
                'size'            => null,
                'type'            => 'blob',
            ],
            'field_varchar'           => [
                'afterField'      => 'field_varbinary',
                'comment'         => '',
                'default'         => null,
                'hasDefault'      => false,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_varchar',
                'options'         => null,
                'scale'           => null,
                'size'            => 10,
                'type'            => 'char',
            ],
            'field_varchar_default'   => [
                'afterField'      => 'field_varchar',
                'comment'         => '',
                'default'         => 'D',
                'hasDefault'      => true,
                'isAutoIncrement' => false,
                'isFirst'         => false,
                'isNotNull'       => false,
                'isNumeric'       => false,
                'isPrimary'       => false,
                'isUnsigned'      => false,
                'name'            => 'field_varchar_default',
                'options'         => null,
                'scale'           => null,
                'size'            => 10,
                'type'            => 'char',
            ],
        ];
        $actual = $sqlite->listColumns($schema, 'co_dialect');

        $this->assertSame($expected, $actual);
    }
}
